@model CobanaEnergy.Project.Models.Signup.UserUpdateViewModel
@{
    ViewBag.Title = "Update User";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@if (User.Identity.IsAuthenticated && User.IsInRole("Controls"))
{
    <div class="create-user-container">
        <div class="form-container">
            <h2 class="form-heading">Update User</h2>

            @using (Html.BeginForm("UpdateUser", "Account", FormMethod.Post, new { id = "updateUserForm", @class = "form-horizontal", role = "form" }))
            {
                @Html.AntiForgeryToken()
                @Html.HiddenFor(m => m.UserId)

                <div class="form-group">
                    @Html.TextBoxFor(m => m.UserName, new
                    {
                        @class = "form-control",
                        placeholder = "Username",
                        @readonly = "readonly",
                        title = "Username cannot be changed"
                    })
                </div>

                <div class="form-group">
                    @Html.TextBoxFor(m => m.Email, new
                    {
                        @class = "form-control",
                        placeholder = "Enter email address",
                        type = "email"
                    })
                    @Html.ValidationMessageFor(m => m.Email, "", new { @class = "text-danger" })
                </div>

                <div class="form-group">
                    @Html.TextBoxFor(m => m.JobTitle, new
                    {
                        @class = "form-control",
                        placeholder = "Enter job title",
                        maxlength = "50"
                    })
                    @Html.ValidationMessageFor(m => m.JobTitle, "", new { @class = "text-danger" })
                </div>

                <div class="form-group">
                    @Html.TextBoxFor(m => m.ExtensionNumber, new
                    {
                        @class = "form-control",
                        placeholder = "Enter extension number",
                        pattern = "^[0-9]*$",
                        title = "Only numbers allowed",
                        maxlength = "10"
                    })
                    @Html.ValidationMessageFor(m => m.ExtensionNumber, "", new { @class = "text-danger" })
                </div>

                <div class="form-group">
                    <button type="submit" class="btn btn-primary mt-2">Update User</button>
                </div>
            }
        </div>
    </div>

    @section scripts {
        @if (TempData["ToastMessage"] != null)
        {
            <script>
                $(function () {
                    const message = "@TempData["ToastMessage"]";
                    const type = "@TempData["ToastType"]";

                    if (type === "success") {
                        showToastSuccess(message);
                    } else if (type === "error") {
                        showToastError(message);
                    }
                });
            </script>
        }

        <script src="~/Scripts/Signup/userUpdate.js"></script>
    }

    @section styles {
        <link href="~/Content/Signup/CreateUser.css" rel="stylesheet" />
    }
}
else
{
    <div class="alert alert-danger text-center mt-5">
        <h4>Access Denied</h4>
        <p>You are not authorized to view this page.</p>
    </div>
}
